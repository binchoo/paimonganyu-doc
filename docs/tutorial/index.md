---
id: index
title: 여행 비서 페이몬! 튜토리얼
sidebar_position: 1
---
![채널 아이콘](resources\kakao_channel_icon_100_100.png)

# 여행 비서 페이몬! 튜토리얼

## 원신 유저를 위한 카카오 챗봇

**「여행 비서 페이몬!」**은 호요버스(前 미호요)가 운영하는 오픈 월드 RPG 게임 [**원신**](https://genshin.hoyoverse.com/ko/)을 대상으로 한 게임 편의성 챗봇입니다.

해당 챗봇은 호요버스 커뮤니티의 API를 래핑하여, 원신 유저에게 다양한 편의 기능을 제공하는 것을 목표로 합니다.

현 시점에 `호요랩 일일 출석`,  `여행자 상태 조회`, `코드 리딤 배포`를 중심으로 기능을 구성하고 있습니다.

![img](resources\channel_profile.png)
> **「여행 비서 페이몬!」 카카오 채널** :point_right: http://pf.kakao.com/_mtPFb
>
> 카카오 채널과 친구를 맺고 챗봇 서비스 이용을 시작할 수 있어요!

여행 가이드 뿐만이 아니라 비서로서의 역할을 자처하는 페이몬! 

페이몬 비서가 <u>여행자들을 대신해 어떤 일을 할 수 있는지</u> 살펴볼까요? 

## 호요랩 일일 출석
![호요랩의 일일출석](resources\hoyolab_dailycheckin.png)
*호요랩 일일 출석 화면*

여행자들은 호요버스의 게임 커뮤니티 [호요랩](https://webstatic-sea.mihoyo.com/ys/event/signin-sea/index.html?act_id=e202102251931481)에 매일 출석하여 소소한 게임 보상을 획득할 수 있습니다. 

그러나 페이몬 비서는 여행자들이 커뮤니티 방문을 귀찮아하고, 출석 체크를 자주 까먹고 있다는 걸 알고 있어요 :cry:.​

> ![페이몬 이모지](resources\kakao_channel_icon_50_50.png)**야박한 보상도 티끌 모아 태산!**
>
> 「여행 비서 페이몬!」에게 당신의 <u>호요버스 통행증을 등록</u>해 줘! 페이몬이 출석 체크를 매일 매일 대신해 줄게~

### 자동 일일 출석 서비스

「여행 비서 페이몬!」은 여행자의 등록된 통행증이 있을 경우, 매일 매일 특정 시각에 :heavy_check_mark:호요랩 일일 출석을 넣어주고 있습니다.![배치 일일 출석 워크플로](resources\batch_dailycheck_workflow.png)
*Cron 기반의 일일 출석 자동화 워크플로*

### 직접 일일 출석도 가능해요

통행증을 등록한 여행자라면 이 통행증을 가지고 페이몬에게 출석 체크를 직접 부탁할 수도 있습니다.

![direct_daily_check_in](resources\direct_daily_check_in.png)

*홈> 통행증 조회> 출석 체크*

또는, *홈> 기능 모음> 일일 출석*



> ![페이몬 이모지](resources\kakao_channel_icon_50_50.png)**패이몬의 호요랩 일일 출석 시점 정리**
>
>   1. 챗봇 사용자가 페이몬에게 직접 출석 체크를 요청할 경우.
>   2. 챗봇 사용자가 페이몬에게 통행증을 등록에 성공한 시점에 1회.
>   3. 매일 3번 8시간 마다 -  서울 시각 1시/9시/17시.
>
> 페이몬은 하루에도 세 번, 여행자를 대신해서 출석 체크를 시도한다는 점 알아줘~

### 일일 출석 이력 조회

페이몬이 여행자를 대신해 일일 출석을 시도한 이력을 모든 통행증에 대해서 확인해 볼 수 있습니다.

![](resources\daily_check_in_log.png)

*홈> 통행증 조회> 출석 체크>  결과 응답> 출첵 로그*

또는, *홈> 기능 모음> 페이몬의 출석 기록 <4*

## 여행자 조회 서비스

![레진 아이콘](resources\resion_icon_50_50.png)

### 실시간 스테이터스 조회

여행자들의 피로도 수치인 **레진**! 게임에 들어가지 않은 동안 얼만큼 쌓였을까 궁금하지 않으세요?

이럴 땐 여행 비서인 페이몬에게 물어보세요. 등록된 모든 여행자 캐릭터들의 스테이터스를 조회하여 알려줄 거예요~.

![여행자 스테이터스](resources\traveler_status.png)

*홈> 실시간 스탯*
또는, *홈> 기능 모음>  실시간 여행자 상태*

> ![페이몬 이모지](resources\kakao_channel_icon_50_50.png)**각 스테이터스 설명!** 
>
> 페이몬이 알려주는 이 값들은 호요랩 API에서 가져오고 있어~.
>
> 1. **레진**: 현재 쌓여있는 레진.
>
> 2. **레진회복**: 레진 풀 회복까지 예상되는 시간.
>
> 3. **선계보화**: 선계에 쌓여있는 선계 코인 수.
>
> 4. **탐사중**: 탐사 파견 상태에 있는 캐릭터 숫자.

### :calendar: 게임 전적 조회

(개발 예정:calendar: 기능입니다.)

「여행 비서 페이몬!」은 호요랩 API 이용 기반이 마련되어 있어서 추후,

게임 전적 데이터를 활용한 기능이 업데이트 될 가능성이 있습니다. 페이몬 비서의 직무 확장을 기대해 주세요!

## 통행증 특강

![열쇠 아이콘](resources\black_key_50_50.png)

> ![페이몬 이모지](resources\paimon_crying_50_50.png) **통행증의 중요성에 대해⋯**
> 통행증이 없다면 페이몬이 여행자 대신 귀찮은 일들을 처리할 수 없어. 비서 실직이라구⋯.
>
> 페이몬 비서와의 "첫 단추"는 통행증 QR을 만들어서 스캔하는 거야. 꼭 기억해!

### 통행증이란?

통행증이란, 호요버스에서 여행자의 호요버스 계정에 부여하는 고유한 인증 정보를 말합니다.

![호요랩 통행증](resources\hoyolab_hoyopass.png)

*(호요랩> 개인 페이지) 본인에게 통행증 ID가 있는 걸 눈치 채셨나요?*



페이몬 비서가 여러분을 대신해 어떻게 호요버스 API를 호출 할 수 있을까요? 

바로 여행자가 등록한 통행증 덕분입니다!



「여행 비서 페이몬!」 이용에 필수 불가결한 **통행증**! 꼭 하나 이상의 통행증을 등록해 주세요.

### 본인의 통행증 값 알아내기

본인의 통행증 정보는 <u>호요랩 로그인 후 브라우저의 쿠키에 세팅</u>되며, 3가지 값으로 구성됩니다.

1. `ltuid`: 호요버스 계정의 통행증 아이디입니다.
2. `ltoken`: 통행증 아이디에 대응되는 개인 토큰입니다.
3. `cookie_token`: 코드 리딤 서비스에서 이용되는 개인 토큰입니다. 



이 세 가지 값을 찾는 방법 - 간단해요!

#### **1단계. HoYoLab에서 로그인**

![호요랩 로그인](resources\hoyopass_login.png)

**PC 브라우저**로 [호요랩](https://www.hoyolab.com/home)에 방문해서 본인의 호요버스 계정으로 로그인 해 주세요.

#### **2단계. 개발자 도구로 쿠키 값 들여다 보기**

![통행증 쿠키](resources\hoyopass_cookies.png)


<details>
  <summary>한국어 단계</summary>
   `개발자도구(F12)` > `응용 프로그램` 탭> `저장소` 섹션> `쿠키` 항목> 호요랩 URL 주소 클릭!
</details>

<details>
  <summary>영어 단계</summary>
   `DevTools(F12)`> `Application` 탭> `Storage` 섹션> `Cookies` 항목> 호요랩 URL 주소 클릭!
</details>


`ltoken`, `ltuid`, `cookie_token` 값을 발견하면 메모장 같은 데에 잘 복사해 두세요~.



## 통행증 관리 서비스

![열쇠 아이콘](resources\black_key_50_50.png)

### QR 코드(보안 통행증) 만들기

[통행증 값 알아내기](./tutorial#본인의-통행증-값-알아내기)에서 통행증 쿠키 값을 모두 확인했나요? 

![image-20220619013518983](resources\create-qr-code.png)

「여행 비서 페이몬!」의 통행증 등록은 QR 코드 스캔으로 이뤄집니다.

[통행증 QR 만들기 페이지](./tutorial/create-qr-code)에서 통행증 쿠키 값들을 QR에 담아 생성해 주세요.

> ![페이몬 이모지](resources\kakao_channel_icon_50_50.png)**QR 코드를 쓰는 이유!**
>
> 통행증을 구성하는 값들이 무척 복잡하지?
>
> 그들을 채팅에다 입력하기 버거울 뿐더러, 개인 정보를 텍스트로 전송하는 건 안전하지 못 해.
>
> 하지만 페이몬하고 만든 QR 코드는 암호 처리가 돼 있어! 그래서 **보안 통행증**이라 부르곤 하지.

> ![루미네 이모지](resources\lumine_dizzy_50_50.png)**QR 코드를 다른 사람한테 공유해도 돼?**
>
> ![페이몬 이모지](resources\paimon_crying_50_50.png) 그래도 안 돼! 걔가 멋대로 스캔해 가 버리면 곤란하잖아⋯.

### 통행증 등록 (QR 스캔)

**통행증 등록**은 여행 비서 페이몬과 <u>처음으로 해야 할 일</u>입니다!



[통행증 QR 만들기 페이지](./tutorial/create-qr-code)에서 QR 코드를 완성하고 챗봇에서 스캔해 주세요.

스캔에 성공하면, 페이몬은 해당 계정 속의 여행자들을 파악할 거예요.

![통행증 등록](resources\hoyopass_register.png)

*하단 메뉴> 통행증 등록* 

또는, *홈> 기능 모음> 통행증 등록* 에서 스캐너를 열고 QR 코드를 스캔 전송하세요.



> **지연 응답 대처**
>
> AWS Labmda의 콜드 스타트와 Springboot의 부트스트랩이 지연을 야기할 수 있습니다. (프로젝트 목적상 기술 스택을 타협할 수 없었습니다.)
>
> 응답 지연 발생시 약 10초의 텀을 가지고 수차례 재시도 해주세요.

### 통행증 조회

페이몬 비서가 관리하는 통행증 정보를 보고 싶으신가요? 그럼 통행증 조회를 요청하여 보세요.

통행증을 조회하고 나서 출석 체크를 요청하거나, 정보 삭제를 요청할 수도 있어요.

![통행증 조회](resources\hoyopass_list.png)

## 코드 리딤 서비스

### 페이몬의 코드 리딤

![img](resources\new_redeem_workflow.png)
*신규 리딤 코드에 대한 전 유저 대상 리딤 워크플로*

> ![페이몬 이모지](resources\kakao_channel_icon_50_50.png) **박애주의자에 대해⋯**
>
> 그거 알아? 페이몬은 (관리자에 의해) 새로운 리딤 코드를 알게 될 때마다
>
> 등록된 모든 여행자의 통행증으로 코드 리딤을 넣어주고 있어~

### :wrench: 유저의 코드 리딤

 (개발중:wrench: 기능입니다.)

> ![페이몬 이모지](resources\kakao_channel_icon_50_50.png) **박애주의자 모집에 대해⋯**
>
> 새로 알게 된 리딤 코드가 있다구? 그럼 페이몬 비서에게도 알려주지 않을래?
>
> 다른 모든 여행자들에게도 똑같이 리딤 코드를 넣어 주겠어~.

### :wrench: 통행증 등록시 코드 리딤

(개발중:wrench: 기능입니다.)

![img](resources\new_user_redeem_workflow.png)
*신규 통행증에 대한 코드 리딤 워크플로*

「여행 비서 페이몬!」 에 통행증을 등록할 경우, 해당 통행증을 대상으로 알려진 모든 리딤 코드가 리딤 시도됩니다. 
